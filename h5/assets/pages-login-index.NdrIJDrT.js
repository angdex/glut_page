import{c as s,w as a,s as e,r as o,i as l,o as t,a as r,b as i,d as n,e as d,f as u,I as c,g as p,n as g,t as f}from"./index-BMZ5TM4R.js";import{_ as h,l as m}from"./_plugin-vue_export-helper.iOdWERSQ.js";const _=h({data:()=>({username:"",password:"",isLoading:!1,error:""}),methods:{async handleLogin(){if(!this.username||!this.password)return void(this.error="请输入学号和密码");this.isLoading=!0,this.error="";const s=setTimeout((()=>{this.isLoading&&(this.isLoading=!1,this.error="请求超时，请重试",console.error("登录安全超时触发"))}),2e4);try{console.log("开始登录请求...");const a=await m(this.username,this.password);console.log("登录结果:",a),clearTimeout(s),a&&a.success?(e("isLoggedIn",!0),e("username",this.username),e("password",this.password),o({url:"/pages/schedule/index"})):(this.isLoading=!1,this.error=a&&a.error||"登录失败，请检查用户名和密码")}catch(a){clearTimeout(s),console.error("登录出错:",a),this.isLoading=!1,this.error=a.message||"登录失败，请检查网络连接"}}}},[["render",function(e,o,h,m,_,L){const w=n,b=l,x=u,y=c,V=p;return t(),s(b,{class:"login-container"},{default:a((()=>[r(b,{class:"login-box"},{default:a((()=>[r(b,{class:"logo-container"},{default:a((()=>[r(w,{class:"logo",src:"/static/school-logo.png",mode:"aspectFit"})])),_:1}),r(b,{class:"title"},{default:a((()=>[d("桂林理工大学")])),_:1}),r(b,{class:"subtitle"},{default:a((()=>[d("课表查询系统")])),_:1}),r(b,{class:"input-group"},{default:a((()=>[r(b,{class:"input-wrapper"},{default:a((()=>[r(x,{class:"input-icon"},{default:a((()=>[d("👤")])),_:1}),r(y,{type:"text",modelValue:_.username,"onUpdate:modelValue":o[0]||(o[0]=s=>_.username=s),placeholder:"请输入学号",class:"input"},null,8,["modelValue"])])),_:1}),r(b,{class:"input-wrapper"},{default:a((()=>[r(x,{class:"input-icon"},{default:a((()=>[d("🔒")])),_:1}),r(y,{type:"password",modelValue:_.password,"onUpdate:modelValue":o[1]||(o[1]=s=>_.password=s),placeholder:"请输入密码",class:"input"},null,8,["modelValue"])])),_:1})])),_:1}),r(V,{class:g(["login-btn",{"login-btn-loading":_.isLoading}]),disabled:_.isLoading,onClick:L.handleLogin},{default:a((()=>[_.isLoading?(t(),s(x,{key:0,class:"btn-loader"})):i("",!0),r(x,null,{default:a((()=>[d(f(_.isLoading?"登录中...":"登 录"),1)])),_:1})])),_:1},8,["disabled","class","onClick"]),_.error?(t(),s(b,{key:0,class:"error-message"},{default:a((()=>[r(x,{class:"error-icon"},{default:a((()=>[d("❗")])),_:1}),r(x,null,{default:a((()=>[d(f(_.error),1)])),_:1})])),_:1})):i("",!0),r(b,{class:"footer"},{default:a((()=>[r(x,{class:"footer-text"},{default:a((()=>[d("教务系统在线查询 © 2023")])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-5b212a4c"]]);export{_ as default};
