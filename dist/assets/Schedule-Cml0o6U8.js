import{d as e,r as a,n as l,c as s,b as t,w as o,e as r,E as u,u as d,f as c,g as n,F as i,p as h,m as p,j as m,s as v,o as f,t as g,h as _,q as y,v as w,k,_ as I}from"./index-BtaR7VRe.js";const Y={class:"schedule-container"},b={class:"schedule-header"},S={class:"date-selector"},D={key:1,class:"schedule-list"},j={class:"course-header"},x={class:"course-info"},C={key:0},M=I(e({__name:"Schedule",setup(e){const I=d(),M=a(!1),T=a((new Date).toISOString().split("T")[0]),U=a([]),V=async()=>{var e;const a=localStorage.getItem("username"),l=localStorage.getItem("password");if(!a||!l)return u.error("登录信息已失效，请重新登录"),void I.push("/login");try{M.value=!0;const s=await fetch(`https://xjeubhfwkdwt.sealoshzh.site/api/schedule?username=${encodeURIComponent(a)}&password=${encodeURIComponent(l)}&date=${T.value}`),t=await s.json();t.success?U.value=t.data:(u.error(t.error||"获取课表失败"),(null==(e=t.error)?void 0:e.includes("登录"))&&I.push("/login"))}catch(s){u.error("网络异常，请稍后重试")}finally{M.value=!1}},$=()=>{localStorage.removeItem("username"),localStorage.removeItem("password"),I.push("/login")};return l((()=>{V()})),(e,a)=>{const l=r("el-icon"),u=r("el-button"),d=r("el-date-picker"),I=r("el-empty"),z=r("el-tag"),R=r("el-card"),q=r("el-backtop");return f(),s("div",Y,[t(R,{class:"schedule-card"},{header:o((()=>[c("div",b,[a[2]||(a[2]=c("h2",null,"课表查询",-1)),t(u,{onClick:$,type:"text"},{default:o((()=>[t(l,null,{default:o((()=>[t(m(v))])),_:1}),a[1]||(a[1]=p(" 退出登录 "))])),_:1})])])),default:o((()=>[c("div",S,[t(d,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value=e),type:"date",placeholder:"选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",disabled:M.value,onChange:V},null,8,["modelValue","disabled"])]),M.value||U.value&&0!==U.value.length?(f(),s("div",D,[(f(!0),s(i,null,h(U.value,((e,a)=>(f(),n(R,{key:a,class:"course-card",shadow:"hover"},{default:o((()=>[c("div",j,[c("h3",null,g(e.course),1),t(z,{size:"small",type:"success"},{default:o((()=>[p(g(e.time),1)])),_:2},1024)]),c("div",x,[c("p",null,[t(l,null,{default:o((()=>[t(m(y))])),_:1}),p(" "+g(e.startTime)+" - "+g(e.endTime),1)]),c("p",null,[t(l,null,{default:o((()=>[t(m(w))])),_:1}),p(" "+g(e.location),1)]),e.teacher?(f(),s("p",C,[t(l,null,{default:o((()=>[t(m(k))])),_:1}),p(" "+g(e.teacher),1)])):_("",!0)])])),_:2},1024)))),128))])):(f(),n(I,{key:0,description:"当天没有课程安排"})),t(q,{right:20,bottom:20})])),_:1})])}}}),[["__scopeId","data-v-ec93805d"]]);export{M as default};
